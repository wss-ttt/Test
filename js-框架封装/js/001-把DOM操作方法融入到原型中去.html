<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <span>span:001</span>
    <span>span:002</span>
    <span>span:003</span>
    <div>div:001</div>
    <div>div:002</div>
    <div>div:003</div>
</body>
<script src="core.js"></script>
<script>
    $.fn.extend({
        // 融入empty方法
        empty: function () {
            for (var i = 0, len = this.length; i < len; i++) {
                this[i].innerHTML = '';
            }
            // 为了链式编程
            return this;
        },
        // 优化版: 借用数组的forEach方法进行遍历 
        _empty: function () {
            [].forEach.call(this, function (val, index) {
                val.innerHTML = '';
            });
            // 为了链式编程
            return this;
        },
        // 优化版: 使用each方法
        __empty: function () {
            this.each(function () {
                this.innerHTML = '';
            });
            // 为了链式编程
            return this;
        },
        // 融入remove方法
        remove: function () {
            for (var i = 0, len = this.length; i < len; i++) {
                // 通过父节点进行删除
                // this[i].parentNode.removeChild(this[i]);
                // 通过自身进行删除
                this[i].remove();
            }
            // 为了链式编程
            return this;
        },
        // 优化版: 借用数组的forEach方法进行遍历操作
        _remove: function () {
            [].forEach.call(this, function (val, index) {
                // 通过父节点进行删除
                // val.parentNode.removeChild(val);
                // 通过自身进行删除
                val.remove();
            });
            // 为了链式编程
            return this;
        },
        // 优化版: 使用each方法
        __remove: function () {
            this.each(function () {
                // 通过父节点进行删除
                // this.parentNode.removeChild(this);
                // 通过自己进行删除
                this.remove();
            });
            // 为了链式编程
            return this;
        },
        // 融入html方法
        html: function (html) {
            if (arguments.length === 0) {
                // 说明是没有传递参数
                return this[0].innerHTML;
            } else {
                for (var i = 0, len = this.length; i < len; i++) {
                    this[i].innerHTML = html;
                }
                // 为了链式编程
                return this;
            }
        },
        // 优化版 : 借用数组的forEach方法进行遍历
        _html: function (html) {
            if (arguments.length === 0) {
                return this[0].innerHTML;
            } else {
                [].forEach.call(this, function (val, index) {
                    val.innerHTML = html;
                });
                // 为了链式编程
                return this;
            }
        },
        // 优化版: 使用each方法
        __html: function (html) {
            if (arguments.length === 0) {
                return this[0].innerHTML;
            } else {
                this.each(function () {
                    this.innerHTML = html;
                });
                // 为了链式编程
                return this;
            }
        },
        // 融入text方法
        text: function (text) {
            var result = '';
            if (arguments.length === 0) {
                for (var i = 0, len = this.length; i < len; i++) {
                    result += this[i].innerText;
                }
                return result;
            } else {
                for (var i = 0, len = this.length; i < len; i++) {
                    this[i].innerText = text;
                }
                // 为了链式编程
                return this;
            }
        },
        // 优化版 : 借用数组的forEach方法进行遍历
        _text: function (text) {
            var result = '';
            if (arguments.length === 0) {
                [].forEach.call(this, function (val, index) {
                    result += val.innerText;
                });
                return result;
            } else {
                [].forEach.call(this, function (val, index) {
                    val.innerText = text;
                });
                // 为了链式编程
                return this;
            }
        },
        // 优化版: 使用each方法
        __text: function (text) {
            var result = '';
            if (arguments.length === 0) {
                this.each(function () {
                    result += this.innerText;
                });
                return result;
            } else {
                this.each(function () {
                    this.innerText = text;
                });
                // 为了链式编程
                return this;
            }
        },
        // 把所有元素(注意这里是所有元素)添加到指定的元素中去
        appendTo: function (selector) {
            /*
                实现思路:
                1.定义一个数组,用来存储被添加的所有元素
                2.使用jQuery工厂函数包装selector,把不同参数统一为jq实例对象(这一个步很重要)
                3.在外层遍历(this),也就是所有被添加的元素
                4.内层遍历所有的包装后的selector返回的jq实例对象(目的地),也就是要被追加的对象
                5.在内层进行判断,如果是第一次,则把外层遍历的元素本体添加内层遍历的元素(目的地)中去
                如果不是第一个,则把外层遍历的元素clone版添加到内层遍历的元素(目的地)中去
                6.最后把被添加的元素添加到数组中去,然后用jQuery工厂函数包装返回
            */
            var result = [], temp = null;
            var $selector = $(selector);
            // 因为被添加的元素可能会有很多,所以需要用到循环
            for (var i = 0, len = this.length; i < len; i++) {
                // 因为目的地也会有很多,所以也需要用到循环
                for (var j = 0, jLen = $selector.length; j < jLen; j++) {
                    if (j === 0) {
                        // 如果是第一次 给目的地添加元素
                        $selector[j].appendChild(this[i]);
                        result.push(this[i]);
                    } else {
                        // 如果不是第一次 给目的地添加元素
                        temp = this[i].cloneNode(true)
                        $selector[j].appendChild(temp);
                        result.push(temp);
                    }
                }
            }
            return jQuery(result);// 进行包装返回 返回的是一个jQuery实例对象
        },
        // 优化版: 使用each方法
        _appendTo: function (selector) {
            var result = [], temp = null;
            var $selector = $(selector);
            // 遍历this(注意这里有三个不同的this)
            this.each(function () {
                var self = this;
                // 遍历目的地$selector
                $selector.each(function (i, val) {
                    // 可以多用三元运算符(比较简洁)
                    temp = i === 0 ? self : self.cloneNode(true);
                    this.appendChild(temp);
                    result.push(temp);
                });
            });
            return jQuery(result);
        }
    });

    // 测试  empty
    // $('div').empty();
    // $('div')._empty();
    // $('div').__empty();

    // 测试  remove
    // $('div').remove();
    // $('div')._remove();
    // $('div').__remove();

    // 测试  html
    // console.log($('div').html());
    // $('div').html('<h1>aaa</h1>');

    // console.log($('div')._html());
    // $('div')._html('<h1>aaa</h1>');

    // console.log($('div').__html());
    // $('div')._html('<h1>aaa</h1>');


    // 测试  text方法
    // console.log($('div').text());
    // $('div').text('<h1>aaa</h1>');

    // console.log($('div')._text());
    // $('div')._text('<h1>aaa</h1>');

    // console.log($('div').__text());
    // $('div').__text('<h1>aaa</h1>');

    // 测试  链式编程
    // console.log($('div').html('<h1>aaa</h1>').toArray());

    // 测试  appendTo
    // 选择器
    // $('span').appendTo('div');

    // DOM
    // var div = document.querySelector('div');// 只会获取到第一个div元素
    // $('span').appendTo(div);

    // jq实例对象
    // $('span').appendTo($('div'));

    // 返回值测试
    var res1 = $('span').appendTo($('div'));
    var res1 = $('span')._appendTo($('div'));
    console.log(res1);
    for (var i = 0; i < res1.length; i++) {
        res1[i].style.color = "red";
    }
</script>

</html>